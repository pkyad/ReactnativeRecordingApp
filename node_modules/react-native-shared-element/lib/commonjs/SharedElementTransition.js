var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.SharedElementTransition=exports.RNAnimatedSharedElementTransitionView=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var React=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _RNSharedElementTransitionView=require("./RNSharedElementTransitionView");var _jsxFileName="/Users/hein/repos/react/react-native-shared-element/src/SharedElementTransition.tsx";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var NativeAnimationType=new Map([['move',0],['fade',1],['fade-in',2],['fade-out',3]]);var NativeResizeType=new Map([['auto',0],['stretch',1],['clip',2],['none',3]]);var NativeAlignType=new Map([['auto',0],['left-top',1],['left-center',2],['left-bottom',3],['right-top',4],['right-center',5],['right-bottom',6],['center-top',7],['center-center',8],['center-bottom',9]]);var debugColors={startNode:'#82B2E8',endNode:'#5EFF9B',pink:'#DC9CFF',startAncestor:'#E88F82',endAncestor:'#FFDC8F'};var debugStyles=_reactNative.StyleSheet.create({overlay:_objectSpread({},_reactNative.StyleSheet.absoluteFillObject,{backgroundColor:'black',opacity:0.3}),text:{marginLeft:3,marginTop:3,fontSize:10},box:{position:'absolute',borderWidth:1,borderStyle:'dashed'}});var RNAnimatedSharedElementTransitionView=_RNSharedElementTransitionView.RNSharedElementTransitionView?_reactNative.Animated.createAnimatedComponent(_RNSharedElementTransitionView.RNSharedElementTransitionView):undefined;exports.RNAnimatedSharedElementTransitionView=RNAnimatedSharedElementTransitionView;var SharedElementTransition=function(_React$Component){(0,_inherits2.default)(SharedElementTransition,_React$Component);(0,_createClass2.default)(SharedElementTransition,null,[{key:"prepareNode",value:function prepareNode(node){var nodeStyle={};if(_reactNative.Platform.OS==='android'&&node&&node.parentInstance){var child=React.Children.only(node.parentInstance.props.children);var props=child?child.props:{};nodeStyle=_reactNative.StyleSheet.flatten([props.style])||{};delete nodeStyle.transform;delete nodeStyle.opacity;nodeStyle.resizeMode=nodeStyle.resizeMode||props.resizeMode;if(nodeStyle.backgroundColor)nodeStyle.backgroundColor=(0,_reactNative.processColor)(nodeStyle.backgroundColor);if(nodeStyle.borderColor)nodeStyle.borderColor=(0,_reactNative.processColor)(nodeStyle.borderColor);if(nodeStyle.color)nodeStyle.color=(0,_reactNative.processColor)(nodeStyle.color);}return node?{nodeHandle:node.nodeHandle,isParent:node.isParent,nodeStyle:nodeStyle}:undefined;}}]);function SharedElementTransition(props){var _this;(0,_classCallCheck2.default)(this,SharedElementTransition);_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(SharedElementTransition).call(this,props));_this.state={};_this.onMeasureNode=function(event){var nativeEvent=event.nativeEvent;var onMeasure=_this.props.onMeasure;_this.setState((0,_defineProperty2.default)({},""+nativeEvent.node,nativeEvent));if(onMeasure){onMeasure(event);}};if(!props.SharedElementComponent&&!SharedElementTransition.isNotAvailableWarningShown){SharedElementTransition.isNotAvailableWarningShown=true;if(_reactNative.Platform.OS==='android'||_reactNative.Platform.OS==='ios'){console.warn('RNSharedElementTransition is not available, did you forget to link `react-native-shared-element` into your project?');}else{console.warn('RNSharedElementTransition is not available on this platform');}}return _this;}(0,_createClass2.default)(SharedElementTransition,[{key:"renderDebugOverlay",value:function renderDebugOverlay(){if(!this.props.debug){return;}return React.createElement(_reactNative.View,{style:debugStyles.overlay,__source:{fileName:_jsxFileName,lineNumber:206}});}},{key:"renderDebugLayer",value:function renderDebugLayer(name){var event=this.state[name];if(!event||!this.props.debug)return;var layout=event.layout,style=event.style;var isContentDifferent=layout.x!==layout.contentX||layout.y!==layout.contentY||layout.width!==layout.contentWidth||layout.height!==layout.contentHeight;var isFullScreen=layout.visibleX===0&&layout.visibleY===0&&layout.visibleWidth===_reactNative.Dimensions.get('window').width&&layout.visibleHeight===_reactNative.Dimensions.get('window').height;var color=debugColors[name];return React.createElement(_reactNative.View,{style:_reactNative.StyleSheet.absoluteFill,__source:{fileName:_jsxFileName,lineNumber:226}},isContentDifferent?React.createElement(_reactNative.View,{style:[debugStyles.box,{left:layout.contentX,top:layout.contentY,width:layout.contentWidth,height:layout.contentHeight,borderColor:color,opacity:0.5}],__source:{fileName:_jsxFileName,lineNumber:228}},React.createElement(_reactNative.Text,{style:[debugStyles.text,{color:color}],__source:{fileName:_jsxFileName,lineNumber:241}},"Content")):undefined,React.createElement(_reactNative.View,{style:[debugStyles.box,{left:layout.x,top:layout.y,width:layout.width,height:layout.height,borderColor:color,borderRadius:style.borderRadius||0}],__source:{fileName:_jsxFileName,lineNumber:246}},React.createElement(_reactNative.Text,{style:[debugStyles.text,{color:color,marginTop:Math.max((style.borderRadius||0)-7,3)}],__source:{fileName:_jsxFileName,lineNumber:259}},name)),React.createElement(_reactNative.View,{style:{position:'absolute',overflow:'hidden',left:layout.visibleX,top:layout.visibleY,width:layout.visibleWidth,height:layout.visibleHeight},__source:{fileName:_jsxFileName,lineNumber:268}},React.createElement(_reactNative.View,{style:[{position:'absolute',left:layout.x-layout.visibleX,top:layout.y-layout.visibleY,width:layout.width,height:layout.height,borderRadius:style.borderRadius||0,backgroundColor:isFullScreen?'transparent':color+'80'}],__source:{fileName:_jsxFileName,lineNumber:278}})));}},{key:"render",value:function render(){var _this$props=this.props,SharedElementComponent=_this$props.SharedElementComponent,start=_this$props.start,end=_this$props.end,position=_this$props.position,animation=_this$props.animation,resize=_this$props.resize,align=_this$props.align,onMeasure=_this$props.onMeasure,debug=_this$props.debug,otherProps=(0,_objectWithoutProperties2.default)(_this$props,["SharedElementComponent","start","end","position","animation","resize","align","onMeasure","debug"]);if(!SharedElementComponent){return null;}return React.createElement(_reactNative.View,{style:_reactNative.StyleSheet.absoluteFill,__source:{fileName:_jsxFileName,lineNumber:314}},React.createElement(SharedElementComponent,(0,_extends2.default)({startNode:{node:SharedElementTransition.prepareNode(start.node),ancestor:SharedElementTransition.prepareNode(start.ancestor)},endNode:{node:SharedElementTransition.prepareNode(end.node),ancestor:SharedElementTransition.prepareNode(end.ancestor)},nodePosition:position,animation:NativeAnimationType.get(animation),resize:NativeResizeType.get(resize),align:NativeAlignType.get(align),onMeasureNode:debug?this.onMeasureNode:onMeasure},otherProps,{__source:{fileName:_jsxFileName,lineNumber:315}})),this.renderDebugLayer('startNode'),this.renderDebugLayer('endNode'));}}]);return SharedElementTransition;}(React.Component);exports.SharedElementTransition=SharedElementTransition;SharedElementTransition.defaultProps={start:{},end:{},SharedElementComponent:RNAnimatedSharedElementTransitionView,animation:'move',resize:'auto',align:'auto'};SharedElementTransition.isNotAvailableWarningShown=false;
//# sourceMappingURL=SharedElementTransition.js.map