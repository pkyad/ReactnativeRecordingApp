import _extends from"@babel/runtime/helpers/extends";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";import _classCallCheck from"@babel/runtime/helpers/classCallCheck";import _possibleConstructorReturn from"@babel/runtime/helpers/possibleConstructorReturn";import _getPrototypeOf from"@babel/runtime/helpers/getPrototypeOf";import _createClass from"@babel/runtime/helpers/createClass";import _inherits from"@babel/runtime/helpers/inherits";import _defineProperty from"@babel/runtime/helpers/defineProperty";var _jsxFileName="/Users/hein/repos/react/react-native-shared-element/src/SharedElementTransition.tsx";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import*as React from'react';import{View,Text,Animated,Dimensions,StyleSheet,processColor,Platform}from'react-native';import{RNSharedElementTransitionView}from'./RNSharedElementTransitionView';var NativeAnimationType=new Map([['move',0],['fade',1],['fade-in',2],['fade-out',3]]);var NativeResizeType=new Map([['auto',0],['stretch',1],['clip',2],['none',3]]);var NativeAlignType=new Map([['auto',0],['left-top',1],['left-center',2],['left-bottom',3],['right-top',4],['right-center',5],['right-bottom',6],['center-top',7],['center-center',8],['center-bottom',9]]);var debugColors={startNode:'#82B2E8',endNode:'#5EFF9B',pink:'#DC9CFF',startAncestor:'#E88F82',endAncestor:'#FFDC8F'};var debugStyles=StyleSheet.create({overlay:_objectSpread({},StyleSheet.absoluteFillObject,{backgroundColor:'black',opacity:0.3}),text:{marginLeft:3,marginTop:3,fontSize:10},box:{position:'absolute',borderWidth:1,borderStyle:'dashed'}});export var RNAnimatedSharedElementTransitionView=RNSharedElementTransitionView?Animated.createAnimatedComponent(RNSharedElementTransitionView):undefined;export var SharedElementTransition=function(_React$Component){_inherits(SharedElementTransition,_React$Component);_createClass(SharedElementTransition,null,[{key:"prepareNode",value:function prepareNode(node){var nodeStyle={};if(Platform.OS==='android'&&node&&node.parentInstance){var child=React.Children.only(node.parentInstance.props.children);var props=child?child.props:{};nodeStyle=StyleSheet.flatten([props.style])||{};delete nodeStyle.transform;delete nodeStyle.opacity;nodeStyle.resizeMode=nodeStyle.resizeMode||props.resizeMode;if(nodeStyle.backgroundColor)nodeStyle.backgroundColor=processColor(nodeStyle.backgroundColor);if(nodeStyle.borderColor)nodeStyle.borderColor=processColor(nodeStyle.borderColor);if(nodeStyle.color)nodeStyle.color=processColor(nodeStyle.color);}return node?{nodeHandle:node.nodeHandle,isParent:node.isParent,nodeStyle:nodeStyle}:undefined;}}]);function SharedElementTransition(props){var _this;_classCallCheck(this,SharedElementTransition);_this=_possibleConstructorReturn(this,_getPrototypeOf(SharedElementTransition).call(this,props));_this.state={};_this.onMeasureNode=function(event){var nativeEvent=event.nativeEvent;var onMeasure=_this.props.onMeasure;_this.setState(_defineProperty({},""+nativeEvent.node,nativeEvent));if(onMeasure){onMeasure(event);}};if(!props.SharedElementComponent&&!SharedElementTransition.isNotAvailableWarningShown){SharedElementTransition.isNotAvailableWarningShown=true;if(Platform.OS==='android'||Platform.OS==='ios'){console.warn('RNSharedElementTransition is not available, did you forget to link `react-native-shared-element` into your project?');}else{console.warn('RNSharedElementTransition is not available on this platform');}}return _this;}_createClass(SharedElementTransition,[{key:"renderDebugOverlay",value:function renderDebugOverlay(){if(!this.props.debug){return;}return React.createElement(View,{style:debugStyles.overlay,__source:{fileName:_jsxFileName,lineNumber:206}});}},{key:"renderDebugLayer",value:function renderDebugLayer(name){var event=this.state[name];if(!event||!this.props.debug)return;var layout=event.layout,style=event.style;var isContentDifferent=layout.x!==layout.contentX||layout.y!==layout.contentY||layout.width!==layout.contentWidth||layout.height!==layout.contentHeight;var isFullScreen=layout.visibleX===0&&layout.visibleY===0&&layout.visibleWidth===Dimensions.get('window').width&&layout.visibleHeight===Dimensions.get('window').height;var color=debugColors[name];return React.createElement(View,{style:StyleSheet.absoluteFill,__source:{fileName:_jsxFileName,lineNumber:226}},isContentDifferent?React.createElement(View,{style:[debugStyles.box,{left:layout.contentX,top:layout.contentY,width:layout.contentWidth,height:layout.contentHeight,borderColor:color,opacity:0.5}],__source:{fileName:_jsxFileName,lineNumber:228}},React.createElement(Text,{style:[debugStyles.text,{color:color}],__source:{fileName:_jsxFileName,lineNumber:241}},"Content")):undefined,React.createElement(View,{style:[debugStyles.box,{left:layout.x,top:layout.y,width:layout.width,height:layout.height,borderColor:color,borderRadius:style.borderRadius||0}],__source:{fileName:_jsxFileName,lineNumber:246}},React.createElement(Text,{style:[debugStyles.text,{color:color,marginTop:Math.max((style.borderRadius||0)-7,3)}],__source:{fileName:_jsxFileName,lineNumber:259}},name)),React.createElement(View,{style:{position:'absolute',overflow:'hidden',left:layout.visibleX,top:layout.visibleY,width:layout.visibleWidth,height:layout.visibleHeight},__source:{fileName:_jsxFileName,lineNumber:268}},React.createElement(View,{style:[{position:'absolute',left:layout.x-layout.visibleX,top:layout.y-layout.visibleY,width:layout.width,height:layout.height,borderRadius:style.borderRadius||0,backgroundColor:isFullScreen?'transparent':color+'80'}],__source:{fileName:_jsxFileName,lineNumber:278}})));}},{key:"render",value:function render(){var _this$props=this.props,SharedElementComponent=_this$props.SharedElementComponent,start=_this$props.start,end=_this$props.end,position=_this$props.position,animation=_this$props.animation,resize=_this$props.resize,align=_this$props.align,onMeasure=_this$props.onMeasure,debug=_this$props.debug,otherProps=_objectWithoutProperties(_this$props,["SharedElementComponent","start","end","position","animation","resize","align","onMeasure","debug"]);if(!SharedElementComponent){return null;}return React.createElement(View,{style:StyleSheet.absoluteFill,__source:{fileName:_jsxFileName,lineNumber:314}},React.createElement(SharedElementComponent,_extends({startNode:{node:SharedElementTransition.prepareNode(start.node),ancestor:SharedElementTransition.prepareNode(start.ancestor)},endNode:{node:SharedElementTransition.prepareNode(end.node),ancestor:SharedElementTransition.prepareNode(end.ancestor)},nodePosition:position,animation:NativeAnimationType.get(animation),resize:NativeResizeType.get(resize),align:NativeAlignType.get(align),onMeasureNode:debug?this.onMeasureNode:onMeasure},otherProps,{__source:{fileName:_jsxFileName,lineNumber:315}})),this.renderDebugLayer('startNode'),this.renderDebugLayer('endNode'));}}]);return SharedElementTransition;}(React.Component);SharedElementTransition.defaultProps={start:{},end:{},SharedElementComponent:RNAnimatedSharedElementTransitionView,animation:'move',resize:'auto',align:'auto'};SharedElementTransition.isNotAvailableWarningShown=false;
//# sourceMappingURL=SharedElementTransition.js.map