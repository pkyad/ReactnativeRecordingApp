import _classCallCheck from"@babel/runtime/helpers/classCallCheck";import _createClass from"@babel/runtime/helpers/createClass";import{RNSharedElementAlign,RNSharedElementResize}from'./types';import{Rect}from'./Rect';function initElement(element){var style=element.style;style.position='absolute';style.left='0px';style.top='0px';style.pointerEvents='none';style.transformOrigin='0% 0%';style.transformStyle='preserve-3d';style.backfaceVisibility='hidden';style.backgroundSize='100% 100%';style.boxSizing='border-box';style.overflow='hidden';return element;}function createTransform(){var translateX=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var translateY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var scaleX=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var scaleY=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;return"matrix3d(\n    "+scaleX+", 0, 0, 0,\n    0, "+scaleY+", 0, 0,\n    0, 0, 1, 0,\n    "+translateX+", "+translateY+", 0, 1\n)";}export var RNSharedElementView=function(){function RNSharedElementView(){_classCallCheck(this,RNSharedElementView);this.parentLayout=Rect.empty;this.element=initElement(document.createElement('div'));this.layout=Rect.empty;this.style=null;this.originalLayout=Rect.empty;this._contentElement=null;this.contentLayout=Rect.empty;this.resize=RNSharedElementResize.Auto;this.align=RNSharedElementAlign.Auto;}_createClass(RNSharedElementView,[{key:"updateLayout",value:function updateLayout(){var layout=this.layout,contentLayout=this.contentLayout,resize=this.resize;if(layout.equals(Rect.empty))return;if(resize===RNSharedElementResize.Stretch||resize===RNSharedElementResize.Auto&&contentLayout.equals(layout)){this.updateLayoutForScale();}else{this.updateLayoutForResize();}this.updateStyle();}},{key:"updateLayoutForScale",value:function updateLayoutForScale(){var layout=this.layout,originalLayout=this.originalLayout,parentLayout=this.parentLayout,element=this.element;var width=originalLayout.width,height=originalLayout.height;var x=layout.x,y=layout.y,scaledWidth=layout.width,scaledHeight=layout.height;var widthPx=width+'px';var heightPx=height+'px';var style=element.style;if(style.width!==widthPx)style.width=widthPx;if(style.height!==heightPx)style.height=heightPx;var translateX=x-parentLayout.x;var translateY=y-parentLayout.y;var scaleX=scaledWidth/width;var scaleY=scaledHeight/height;style.transform=createTransform(translateX,translateY,scaleX,scaleY);var _ref=this._contentElement,contentStyle=_ref.style;if(contentStyle.width!==widthPx)contentStyle.width=widthPx;if(contentStyle.height!==heightPx)contentStyle.height=heightPx;contentStyle.transform=createTransform();}},{key:"updateLayoutForResize",value:function updateLayoutForResize(){var layout=this.layout,parentLayout=this.parentLayout,element=this.element,contentLayout=this.contentLayout,originalLayout=this.originalLayout,align=this.align,resize=this.resize;var x=layout.x,y=layout.y,width=layout.width,height=layout.height;var widthPx=width+'px';var heightPx=height+'px';var style=element.style;if(style.width!==widthPx)style.width=widthPx;if(style.height!==heightPx)style.height=heightPx;var translateX=x-parentLayout.x;var translateY=y-parentLayout.y;style.transform=createTransform(translateX,translateY);if(!this._contentElement)return;var contentX=contentLayout.x,contentY=contentLayout.y,contentWidth=contentLayout.width,contentHeight=contentLayout.height;var overflow='hidden';switch(resize){case RNSharedElementResize.Auto:break;case RNSharedElementResize.Stretch:contentWidth=width;contentHeight=height;break;case RNSharedElementResize.Clip:contentWidth=originalLayout.width;contentHeight=originalLayout.height;break;case RNSharedElementResize.None:contentWidth=originalLayout.width;contentHeight=originalLayout.height;overflow='visible';break;}switch(align){case RNSharedElementAlign.LeftTop:contentX=0;contentY=0;break;case RNSharedElementAlign.LeftCenter:contentX=0;contentY=(height-contentHeight)/2;break;case RNSharedElementAlign.LeftBottom:contentX=0;contentY=height-contentHeight;break;case RNSharedElementAlign.RightTop:contentX=width-contentWidth;contentY=0;break;case RNSharedElementAlign.RightCenter:contentX=width-contentWidth;contentY=(height-contentHeight)/2;break;case RNSharedElementAlign.RightBottom:contentX=width-contentWidth;contentY=height-contentHeight;break;case RNSharedElementAlign.CenterTop:contentX=(width-contentWidth)/2;contentY=0;break;case RNSharedElementAlign.Auto:case RNSharedElementAlign.CenterCenter:contentX=(width-contentWidth)/2;contentY=(height-contentHeight)/2;break;case RNSharedElementAlign.CenterBottom:contentX=(width-contentWidth)/2;contentY=height-contentHeight;break;}var contentWidthPx=contentWidth+'px';var contentHeightPx=contentHeight+'px';var contentStyle=this._contentElement.style;if(contentStyle.width!==widthPx)contentStyle.width=contentWidthPx;if(contentStyle.height!==heightPx)contentStyle.height=contentHeightPx;contentStyle.transform=createTransform(contentX,contentY);if(element.style.overflow!==overflow){element.style.overflow=overflow;}}},{key:"updateStyle",value:function updateStyle(){}},{key:"contentElement",get:function get(){return this._contentElement;},set:function set(value){if(this._contentElement===value)return;if(this._contentElement){this.element.removeChild(this._contentElement);}this._contentElement=value?initElement(value):null;if(this._contentElement){this.element.appendChild(this._contentElement);}}}]);return RNSharedElementView;}();
//# sourceMappingURL=RNSharedElementView.js.map